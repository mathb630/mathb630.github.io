<!DOCTYPE html>
<head>
    <meta charset=utf-8 />
    <title>Tiles Map</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <link href='https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.css' rel='stylesheet' />
    <link rel="stylesheet" href="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/themes/css/cartodb.css" />
    <style>
        body {
            margin: 0;
            padding: 0;
        }
        #map {
            position:absolute;
            top:0;
            bottom:0;
            width:100%;
        }
    </style>
</head>

<body>
    <div id='map'></div>

   <!--  Important:  Both mapbox.js and cartodb.js use Leaflet, so loading both libraries would load leaflet twice and cause problems.  Mapbox has a "standalone" version of their library that does not inlude leaflet, so in this scenario we are using leaflet provided by cartodb.js -->
    <script src="https://cartodb-libs.global.ssl.fastly.net/cartodb.js/v3/3.15/cartodb.uncompressed.js"></script>
    <script src='https://api.tiles.mapbox.com/mapbox.js/v2.2.1/mapbox.standalone.js'></script>
    <script>
        L.mapbox.accessToken = 'pk.eyJ1IjoibWF0aGI2MzAiLCJhIjoiY2oxb2Fna3V3MDE0bzJ3bWh2c2ZpY3k3MCJ9.DG2fE82nUVfV24flWX15bw';

        var map = L.map('map', {
            zoom: 12
        });

        map.addControl(L.mapbox.geocoderControl('mapbox.places', {
            keepOpen: true
        }));

        var layers = {
            Streets: L.mapbox.tileLayer('svpvertex.ml8nijl4'),
                        Imagery: L.mapbox.tileLayer('svpvertex.m0ammo9e')
        };

        layers.Streets.addTo(map);

        //add cartoDB layer, set z-index so it shows up on top
        cartodb.createLayer(map, 'https://bm8993.cartodb.com/api/v2/viz/72e1d3c4-f8f5-11e6-835c-0e3ebc282e83/viz.json').addTo(map)
        .on('done', function(layer) {
            layer.setZIndex(5);
        });

        L.control.layers(layers).addTo(map);

    </script>
</body>
